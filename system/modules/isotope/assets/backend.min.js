var Isotope={mediaManager:function(e,t,n){var r=document.id(n).getFirst("table");var i=r.getFirst("tbody");var s=document.id(e).getParent("tr");var o=i.getChildren();Backend.getScrollOffset();switch(t){case"up":s.getPrevious()?s.injectBefore(s.getPrevious()):s.injectInside(i);break;case"down":s.getNext()?s.injectAfter(s.getNext()):s.injectBefore(i.getFirst());break;case"delete":s.destroy();break}o=i.getChildren();for(var u=0;u<o.length;u++){var a=o[u].getChildren();for(var f=0;f<a.length;f++){var l=a[f].getFirst();if(l.type=="hidden"||l.type=="text"||l.type=="textarea"){l.name=l.name.replace(/\[[0-9]+\]/ig,"["+u+"]")}}}},attributeWizard:function(e,t,n){var r=document.id(n);var i=document.id(e).getParent(".row");Backend.getScrollOffset();switch(t){case"up":if(!i.getPrevious(".row")){i.injectInside(r)}else{i.injectBefore(i.getPrevious(".row"))}break;case"down":if(i.getNext(".row")){i.injectAfter(i.getNext(".row"))}else{var s=r.getFirst(".row");i.injectBefore(s)}break}},fieldWizard:function(e,t,n){var r=document.id(n);var i=r.getFirst().getNext();var s=document.id(e).getParent("tr");var o=i.getChildren();Backend.getScrollOffset();switch(t){case"copy":var u=new Element("tr");var a=s.getChildren();for(var f=0;f<a.length;f++){var l=a[f].clone(true).injectInside(u);l.getFirst().value=a[f].getFirst().value;if(l.getFirst().type=="checkbox"){l.getFirst().checked=a[f].getFirst().checked?"checked":"";if(Browser.Engine.trident&&Browser.Engine.version<5)l.innerHTML=l.innerHTML.replace(/CHECKED/ig,'checked="checked"')}}u.injectAfter(s);break;case"up":s.getPrevious()?s.injectBefore(s.getPrevious()):s.injectInside(i);break;case"down":s.getNext()?s.injectAfter(s.getNext()):s.injectBefore(i.getFirst());break;case"delete":o.length>1?s.destroy():null;break}o=i.getChildren();var c=new Array("value","label","default");for(var f=0;f<o.length;f++){var a=o[f].getChildren();for(var h=0;h<a.length;h++){var p=a[h].getFirst();if(p.type=="text"||p.type=="checkbox"||p.type=="hidden"){p.name=p.name.replace(/\[[0-9]+\]/ig,"["+f+"]")}}}},toggleCheckboxGroup:function(e,t){var n=document.id(e).className;var r=document.id(e).checked?"checked":"";if(n=="tl_checkbox"){$$("#"+t+" .tl_checkbox").each(function(e){if(!e.disabled)e.checked=r})}else if(n=="tl_tree_checkbox"){$$("#"+t+" .parent .tl_tree_checkbox").each(function(e){if(!e.disabled)e.checked=r})}Backend.getScrollOffset()},toggleProductTree:function(e,t,n,r,i){e.blur();var s=document.id(t);var o=document.id(e).getFirst();if(s){if(s.getStyle("display")=="none"){s.setStyle("display","inline");o.src=o.src.replace("folPlus.gif","folMinus.gif");document.id(e).title=CONTAO_COLLAPSE;(new Request.Contao).post({action:"toggleProductTree",id:t,state:1,REQUEST_TOKEN:REQUEST_TOKEN})}else{s.setStyle("display","none");o.src=o.src.replace("folMinus.gif","folPlus.gif");document.id(e).title=CONTAO_EXPAND;(new Request.Contao).post({action:"toggleProductTree",id:t,state:0,REQUEST_TOKEN:REQUEST_TOKEN})}return false}(new Request.Contao({onRequest:AjaxRequest.displayBox("Loading data …"),onSuccess:function(n,r){var u=new Element("ul");u.addClass("level_"+i);u.set("html",n);s=new Element("li");s.addClass("parent");s.setProperty("id",t);s.setStyle("display","inline");u.injectInside(s);s.injectAfter(document.id(e).getParent("li"));document.id(e).title=CONTAO_COLLAPSE;o.src=o.src.replace("folPlus.gif","folMinus.gif");AjaxRequest.hideBox();window.fireEvent("ajax_change")}})).post({action:"loadProductTree",id:t,level:i,field:n,name:r,state:1,REQUEST_TOKEN:REQUEST_TOKEN});return false},toggleProductGroupTree:function(e,t,n,r,i){e.blur();Backend.getScrollOffset();var s=$(t),o=$(e).getFirst("img");if(s){if(s.getStyle("display")=="none"){s.setStyle("display","inline");o.src=o.src.replace("folPlus.gif","folMinus.gif");$(e).store("tip:title",Contao.lang.collapse);(new Request.Contao).post({action:"toggleProductGroupTree",id:t,state:1,REQUEST_TOKEN:Contao.request_token})}else{s.setStyle("display","none");o.src=o.src.replace("folMinus.gif","folPlus.gif");$(e).store("tip:title",Contao.lang.expand);(new Request.Contao).post({action:"toggleProductGroupTree",id:t,state:0,REQUEST_TOKEN:Contao.request_token})}return false}(new Request.Contao({field:e,evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(n,r){var s=new Element("li",{id:t,"class":"parent",styles:{display:"inline"}});var u=(new Element("ul",{"class":"level_"+i,html:n})).inject(s,"bottom");s.inject($(e).getParent("li"),"after");s.getElements("a").each(function(e){e.href=e.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)});$(e).store("tip:title",Contao.lang.collapse);o.src=o.src.replace("folPlus.gif","folMinus.gif");AjaxRequest.hideBox();window.fireEvent("ajax_change")}})).post({action:"loadProductGroupTree",id:t,level:i,field:n,name:r,state:1,REQUEST_TOKEN:Contao.request_token});return false},openModalGroupSelector:function(e){var t=e||{};var n=(window.getSize().y-180).toInt();if(!t.height||t.height>n)t.height=n;var r=new SimpleModal({width:t.width,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});r.addButton(Contao.lang.close,"btn",function(){this.hide()});r.addButton(Contao.lang.apply,"btn primary",function(){var e=[],n=null,r=window.frames;for(var i=0;i<r.length;i++){if(r[i].name=="simple-modal-iframe"){n=r[i];break}}if(n===null){alert("Could not find the SimpleModal frame");return}var s=n.document.getElementById("tl_listing").getElementsByTagName("input");for(var i=0;i<s.length;i++){if(!s[i].checked||s[i].id.match(/^check_all_/))continue;if(!s[i].id.match(/^reset_/))e.push(s[i].get("value"))}(new Request.Contao({onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){if(e!=""){window.location.href=e}}})).post({action:t.action,value:e[0],redirect:t.redirect,REQUEST_TOKEN:Contao.request_token});this.hide();if(t.trigger){t.trigger.fireEvent("closeModal")}});r.show({title:t.title,contents:'<iframe src="'+t.url+'" name="simple-modal-iframe" width="100%" height="'+t.height+'" frameborder="0"></iframe>',model:"modal"});return r},addInteractiveHelp:function(){new Tips.Contao("a.tl_tip",{offset:{x:9,y:21},text:function(e){return e.get("longdesc")}})},inheritFields:function(e,t){var n=false;e.each(function(e,r){var i=document.id("ctrl_"+e);if(i){var s=i.getParent("div").getFirst("h3");if(!s&&i.match(".tl_checkbox_single_container")){s=i}if(!s){n=true;return}s.addClass("inherit");var o=document.id("ctrl_inherit").getFirst("input[value="+e+"]");o.setStyle("float","right").inject(s);document.id("ctrl_inherit").getFirst("label[for="+o.get("id")+"]").setStyles({"float":"right","padding-right":"5px","font-weight":"normal"}).set("text",t).inject(s);o.addEvent("change",function(e){var t=document.id("ctrl_"+e.target.get("value"));if(t.match(".tl_checkbox_single_container")){t.getFirst("input[type=checkbox]").disabled=e.target.checked}else{if(!t.getNext()||!t.getNext().get("id")||!t.getNext().get("id").test(/_parent$/)){t.setStyle("display",e.target.checked?"none":"inherit")}try{t.getNext(":not(.tl_tip):not(script)").setStyle("display",e.target.checked?"none":"inherit")}catch(n){}}});if(i.match(".tl_checkbox_single_container")){i.getFirst("input[type=checkbox]").disabled=o.checked}else{i.setStyle("display",o.checked?"none":"inherit");try{i.getNext(":not(.tl_tip):not(script)").setStyle("display",o.checked?"none":"inherit")}catch(u){}}}});if(!n){document.id("ctrl_inherit").getParent("div").setStyle("display","none")}},initializeToolsMenu:function(){var e=document.getElements("#tl_buttons .isotope-tools");if(e.length<1)return;e.each(function(e){e.previousSibling.nodeValue=""});document.getElement("a.header_isotope_tools").addEvent("click",function(e){document.id("isotopetoolsmenu").setStyle("display","block");return false}).setStyle("display","inline");var t=(new Element("div",{id:"isotopetoolsmenu",styles:{top:$$("a.header_isotope_tools")[0].getPosition().y+22}})).adopt(e).inject(document.id(document.body)).setStyle("left",$$("a.header_isotope_tools")[0].getPosition().x-7);document.id(document.body).addEvent("click",function(){document.id("isotopetoolsmenu").setStyle("display","none")})},initializeFilterMenu:function(){var e=document.getElements("#tl_buttons .isotope-filter");if(e.length<1)return;e.each(function(e){e.previousSibling.nodeValue=""});document.getElement("a.header_iso_filter").addEvent("click",function(e){document.id("isotopefiltermenu").setStyle("display","block");return false}).setStyle("display","inline");var t=(new Element("div",{id:"isotopefiltermenu",styles:{top:$$("a.header_iso_filter")[0].getPosition().y+22}})).adopt(e).inject(document.id(document.body)).setStyle("left",$$("a.header_iso_filter")[0].getPosition().x-7);document.id(document.body).addEvent("click",function(){document.id("isotopefiltermenu").setStyle("display","none")})},makePageViewSortable:function(e){var t=new Sortables(e,{contstrain:true,opacity:.6});t.active=false;t.addEvent("start",function(){t.active=true});t.addEvent("complete",function(e){if(!t.active){return}if(e.getPrevious()){var n=e.get("id").replace(/li_/,"");var r=e.getPrevious().get("id").replace(/li_/,"");var i=window.location.search.replace(/id=[0-9]*/,"id="+n)+"&act=cut&mode=1&page_id="+r;(new Request({url:window.location.href,method:"get",data:i})).send()}else if(e.getParent()){var n=e.get("id").replace(/li_/,"");var r=e.getParent().get("id").replace(/ul_/,"");var i=window.location.search.replace(/id=[0-9]*/,"id="+n)+"&act=cut&mode=2&page_id="+r;(new Request({url:window.location.href,method:"get",data:i})).send()}})}};window.addEvent("domready",function(){Isotope.addInteractiveHelp();Isotope.initializeToolsMenu();Isotope.initializeFilterMenu()}).addEvent("structure",function(){Isotope.addInteractiveHelp()})