var Isotope={};!function(){"use strict";Isotope.toggleCheckboxGroup=function(e,t){var n=document.id(e).className,o=document.id(e).checked?"checked":"";"tl_checkbox"==n?$$("#"+t+" .tl_checkbox").each(function(e){e.disabled||(e.checked=o)}):"tl_tree_checkbox"==n&&$$("#"+t+" .parent .tl_tree_checkbox").each(function(e){e.disabled||(e.checked=o)}),Backend.getScrollOffset()},Isotope.openModalGroupSelector=function(e){var i=e||{},e=(window.getSize().y-180).toInt();(!i.height||i.height>e)&&(i.height=e);e=new SimpleModal({width:i.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});return e.addButton(Contao.lang.close,"btn",function(){this.hide()}),e.addButton(Contao.lang.apply,"btn primary",function(){for(var e=[],t=null,n=window.frames,o=0;o<n.length;o++)if("simple-modal-iframe"==n[o].name){t=n[o];break}if(null!==t){for(var a=(t.document.getElementById("tl_listing")||t.document.getElementById("tl_select")).getElementsByTagName("input"),o=0;o<a.length;o++)a[o].checked&&!a[o].id.match(/^check_all_/)&&(a[o].id.match(/^reset_/)||e.push(a[o].get("value")));new Request.Contao({evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){""!=e&&(window.location.href=e)},onFailure:function(e){-1<[302,303,307].indexOf(e.status)&&""!=e.responseText&&(window.location.href=e.responseText)}}).post({action:i.action,value:e[0],redirect:i.redirect,REQUEST_TOKEN:Contao.request_token}),this.hide(),i.trigger&&i.trigger.fireEvent("closeModal")}else alert("Could not find the SimpleModal frame")}),e.show({title:i.title,contents:'<iframe src="'+i.url+'" name="simple-modal-iframe" width="100%" height="'+i.height+'" frameborder="0"></iframe>',model:"modal"}),e},Isotope.openModalPageSelector=function(e){var i=e||{},e=(window.getSize().y-180).toInt();(!i.height||i.height>e)&&(i.height=e);e=new SimpleModal({width:i.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});return e.addButton(Contao.lang.close,"btn",function(){this.hide()}),e.addButton(Contao.lang.apply,"btn primary",function(){for(var e=0,t=null,n=window.frames,o=0;o<n.length;o++)if("simple-modal-iframe"==n[o].name){t=n[o];break}if(null!==t){for(var a=(t.document.getElementById("tl_listing")||t.document.getElementById("tl_select")).getElementsByTagName("input"),o=0;o<a.length;o++)a[o].checked&&!a[o].id.match(/^check_all_/)&&(a[o].id.match(/^reset_/)||(e=a[o].get("value")));new Request.Contao({evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){""!=e&&(window.location.href=e)},onFailure:function(e){-1<[302,303,307].indexOf(e.status)&&""!=e.responseText&&(window.location.href=e.responseText)}}).post({action:i.action,value:e,redirect:i.redirect,REQUEST_TOKEN:Contao.request_token}),this.hide()}else alert("Could not find the SimpleModal frame")}),e.show({title:i.title,contents:'<iframe src="'+i.url+'" name="simple-modal-iframe" width="100%" height="'+i.height+'" frameborder="0"></iframe>',model:"modal"}),e},Isotope.addInteractiveHelp=function(){new Tips.Contao("a.tl_tip",{offset:{x:9,y:21},text:function(e){return e.get("longdesc")}})},Isotope.inheritFields=function(e,i){var l=!1;e.each(function(e,t){var n=document.id("ctrl_"+e);if(n){n.removeProperty("required");var o=n.getParent("div").getFirst("h3");if(!o&&n.match(".tl_checkbox_single_container")&&(o=n),o){o.addClass("inherit");var a=document.id("ctrl_inherit").getFirst("input[value="+e+"]");if(a.setStyle("float","right").inject(o),document.id("ctrl_inherit").getFirst("label[for="+a.get("id")+"]").setStyles({float:"right","padding-right":"5px","font-weight":"normal"}).set("text",i).inject(o),a.addEvent("change",function(e){var t=document.id("ctrl_"+e.target.get("value"));if(t.match(".tl_checkbox_single_container"))t.getFirst("input[type=checkbox]").disabled=e.target.checked;else{(t.getPrevious()&&t.getPrevious().hasClass("mce-tinymce")?t.getPrevious():t).setStyle("display",e.target.checked?"none":null);try{t.getAllNext(":not(script)").setStyle("display",e.target.checked?"none":null)}catch(e){}}}),n.match(".tl_checkbox_single_container"))n.getFirst("input[type=checkbox]").disabled=a.checked;else{n.setStyle("display",a.checked?"none":null);try{n.getAllNext(":not(script)").setStyle("display",a.checked?"none":null)}catch(e){}}}else l=!0}}),l||document.id("ctrl_inherit").getParent("div").setStyle("display","none")},Isotope.makeSelectExtendable=function(){var i={};document.getElements("select.extendable").forEach(function(n){var o=n.value,a=n.getParent("table").id;i[a]=i[a]||[],i[a].push(n),n.grab(new Element("option",{text:"Add …",value:"extendSelect"})).addEvent("change",function(e){var t;"extendSelect"==n.value?(""!=(t=prompt("Please enter the new group name."))?(a&&i[a]?i[a].forEach(function(e){new Element("option",{text:t,value:t}).inject(e.getLast(),"before")}):new Element("option",{text:t,value:t}).inject(n.getLast(),"before"),n.value=t,o=t):n.value=o,n.fireEvent("change")):o=n.value})})},Isotope.makeParentViewSortable=function(e){var t=new Scroller(document.getElement("body"),{onChange:function(e,t){this.element.scrollTo(this.element.getScroll().x,t)}}),i=new Sortables(e,{contstrain:!0,opacity:.6,onStart:function(){t.start()},onComplete:function(){t.stop()},onSort:function(e){var t,n,o,a=e.getFirst("div");a&&(a.hasClass("wrapper_start")?((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.removeClass("indent"),(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.addClass("indent")):a.hasClass("wrapper_stop")?((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.addClass("indent"),(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.removeClass("indent")):a.hasClass("indent")?((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.hasClass("wrapper_stop")||(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.hasClass("wrapper_start"))&&a.removeClass("indent"):((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.hasClass("wrapper_start")||(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.hasClass("wrapper_stop"))&&a.addClass("indent"))},handle:".drag-handle"});i.active=!1,i.addEvent("start",function(){i.active=!0}),i.addEvent("complete",function(e){var t,n,o,a;i.active&&(e.getPrevious("li")?(t=e.get("id").replace(/li_/,""),n=e.getPrevious("li").get("id").replace(/li_/,""),o=window.location.search.replace(/id=[0-9]*/,"id="+t)+"&act=cut&mode=1&page_id="+n,a=window.location.href.replace(/\?.*$/,""),new Request.Contao({url:a+o,followRedirects:!1}).get()):e.getParent("ul")&&(t=e.get("id").replace(/li_/,""),n=e.getParent("ul").get("id").replace(/ul_/,""),o=window.location.search.replace(/id=[0-9]*/,"id="+t)+"&act=cut&mode=2&page_id="+n,a=window.location.href.replace(/\?.*$/,""),new Request.Contao({url:a+o,followRedirects:!1}).get()))})}}(),Isotope.MediaManager={},function(){"use strict";Isotope.MediaManager.init=function(e,o,t){var a,i,l,r,s,c=$("ctrl_"+o),d=[],t={element:document.id(e),request:{endpoint:window.location.href,inputName:o,params:{action:"uploadMediaManager",name:o,REQUEST_TOKEN:Contao.request_token}},failedUploadTextDisplay:{mode:"custom",maxChars:50,responseProperty:"error"},validation:{allowedExtensions:t},callbacks:{onUpload:function(){AjaxRequest.displayBox(Contao.lang.loading+" …")},onComplete:function(e,t,n){if(n.success){if(n.file&&d.push(n.file),!(0<this.getInProgress())){for(s={},l=c.getElements('[name^="'+o+'"]'),a=0;a<l.length;a++)3==(r=l[a].get("name").split("[")).length&&(i=r[1].replace("]",""),s[i]||(s[i]={}),r=r[2].replace("]",""),"radio"==l[a].get("type")?(s[i][r]||(s[i][r]=""),l[a].get("checked")&&(s[i][r]=l[a].get("value"))):s[i][r]=l[a].get("value"));new Request.Contao({evalScripts:!1,onSuccess:function(e,t){c.getElement("div").set("html",t.content),t.javascript&&Browser.exec(t.javascript),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"reloadMediaManager",name:o,value:s,files:d,REQUEST_TOKEN:Contao.request_token}),d=[]}}else AjaxRequest.hideBox()}}};return new qq.FineUploader(t)},Isotope.MediaManager.makeSortable=function(){$$(".tl_mediamanager .sortable").each(function(e){new Sortables(e,{contstrain:!0,opacity:.6,handle:".drag-handle",onComplete:function(){Isotope.MediaManager.resort(e)}})})},Isotope.MediaManager.act=function(e,t,n){n=document.id(n).getElement("table").getFirst("tbody"),e=document.id(e).getParent("tr"),n.getChildren();switch(Backend.getScrollOffset(),t){case"up":e.getPrevious()?e.injectBefore(e.getPrevious()):e.injectInside(n);break;case"down":e.getNext()?e.injectAfter(e.getNext()):e.injectBefore(n.getFirst());break;case"delete":e.destroy()}Isotope.MediaManager.resort(n)},Isotope.MediaManager.resort=function(e){for(var t,n,o,a=e.getChildren(),i=0;i<a.length;i++){for(t=a[i].getElements("[name]"),o=0;o<t.length;o++)t[o].name=t[o].name.replace(/\[[0-9]+\]/g,"["+i+"]"),t[o].id=t[o].id.replace(/_[0-9]+/g,"_"+i);for(n=a[i].getElements("label"),o=0;o<n.length;o++)n[o].set("for",n[o].get("for").replace(/_[0-9]+/g,"_"+i))}}}(),window.addEvent("domready",function(){Isotope.addInteractiveHelp(),Isotope.makeSelectExtendable(),Isotope.MediaManager.makeSortable()}).addEvent("structure",function(){Isotope.addInteractiveHelp()}),window.addEvent("ajax_change",function(){Isotope.addInteractiveHelp(),Isotope.MediaManager.makeSortable()});