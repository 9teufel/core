var Isotope={};!function(){"use strict";Isotope.toggleCheckboxGroup=function(a,b){var c=document.id(a).className,d=document.id(a).checked?"checked":"";"tl_checkbox"==c?$$("#"+b+" .tl_checkbox").each(function(a){a.disabled||(a.checked=d)}):"tl_tree_checkbox"==c&&$$("#"+b+" .parent .tl_tree_checkbox").each(function(a){a.disabled||(a.checked=d)}),Backend.getScrollOffset()},Isotope.openModalGroupSelector=function(a){var b=a||{},c=(window.getSize().y-180).toInt();(!b.height||b.height>c)&&(b.height=c);var d=new SimpleModal({width:b.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});return d.addButton(Contao.lang.close,"btn",function(){this.hide()}),d.addButton(Contao.lang.apply,"btn primary",function(){for(var a=[],c=null,d=window.frames,e=0;e<d.length;e++)if("simple-modal-iframe"==d[e].name){c=d[e];break}if(null===c)return alert("Could not find the SimpleModal frame"),void 0;for(var f=c.document.getElementById("tl_listing").getElementsByTagName("input"),e=0;e<f.length;e++)f[e].checked&&!f[e].id.match(/^check_all_/)&&(f[e].id.match(/^reset_/)||a.push(f[e].get("value")));new Request.Contao({evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(a){""!=a&&(window.location.href=a)}}).post({action:b.action,value:a[0],redirect:b.redirect,REQUEST_TOKEN:Contao.request_token}),this.hide(),b.trigger&&b.trigger.fireEvent("closeModal")}),d.show({title:b.title,contents:'<iframe src="'+b.url+'" name="simple-modal-iframe" width="100%" height="'+b.height+'" frameborder="0"></iframe>',model:"modal"}),d},Isotope.openModalPageSelector=function(a){var b=a||{},c=(window.getSize().y-180).toInt();(!b.height||b.height>c)&&(b.height=c);var d=new SimpleModal({width:b.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});return d.addButton(Contao.lang.close,"btn",function(){this.hide()}),d.addButton(Contao.lang.apply,"btn primary",function(){for(var a=0,c=null,d=window.frames,e=0;e<d.length;e++)if("simple-modal-iframe"==d[e].name){c=d[e];break}if(null===c)return alert("Could not find the SimpleModal frame"),void 0;for(var f=c.document.getElementById("tl_listing").getElementsByTagName("input"),e=0;e<f.length;e++)f[e].checked&&!f[e].id.match(/^check_all_/)&&(f[e].id.match(/^reset_/)||(a=f[e].get("value")));new Request.Contao({evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(a){""!=a&&(window.location.href=a)}}).post({action:b.action,value:a,redirect:b.redirect,REQUEST_TOKEN:Contao.request_token}),this.hide()}),d.show({title:b.title,contents:'<iframe src="'+b.url+'" name="simple-modal-iframe" width="100%" height="'+b.height+'" frameborder="0"></iframe>',model:"modal"}),d},Isotope.addInteractiveHelp=function(){new Tips.Contao("a.tl_tip",{offset:{x:9,y:21},text:function(a){return a.get("longdesc")}})},Isotope.inheritFields=function(a,b){var c=!1;a.each(function(a){var d=document.id("ctrl_"+a);if(d){var e=d.getParent("div").getFirst("h3");if(!e&&d.match(".tl_checkbox_single_container")&&(e=d),!e)return c=!0,void 0;e.addClass("inherit");var f=document.id("ctrl_inherit").getFirst("input[value="+a+"]");if(f.setStyle("float","right").inject(e),document.id("ctrl_inherit").getFirst("label[for="+f.get("id")+"]").setStyles({"float":"right","padding-right":"5px","font-weight":"normal"}).set("text",b).inject(e),f.addEvent("change",function(a){var b=document.id("ctrl_"+a.target.get("value"));if(b.match(".tl_checkbox_single_container"))b.getFirst("input[type=checkbox]").disabled=a.target.checked;else{b.getNext()&&b.getNext().get("id")&&-1==!b.getNext().get("id").search(/_parent$/)||b.setStyle("display",a.target.checked?"none":"inherit");try{b.getNext(":not(.tl_tip):not(script)").setStyle("display",a.target.checked?"none":"inherit")}catch(c){}}}),d.match(".tl_checkbox_single_container"))d.getFirst("input[type=checkbox]").disabled=f.checked;else{d.setStyle("display",f.checked?"none":"inherit");try{d.getNext(":not(.tl_tip):not(script)").setStyle("display",f.checked?"none":"inherit")}catch(g){}}}}),c||document.id("ctrl_inherit").getParent("div").setStyle("display","none")},Isotope.makeSelectExtendable=function(){var a={};document.getElements("select.extendable").forEach(function(b){var c=b.value,d=b.getParent("table").id;a[d]=a[d]||[],a[d].push(b),b.grab(new Element("option",{text:"Add …",value:"extendSelect"})).addEvent("change",function(){if("extendSelect"==b.value){var e=prompt("Please enter the new group name.");""!=e?(d&&a[d]?a[d].forEach(function(a){new Element("option",{text:e,value:e}).inject(a.getLast(),"before")}):new Element("option",{text:e,value:e}).inject(b.getLast(),"before"),b.value=e,c=e):b.value=c,b.fireEvent("change")}else c=b.value})})},Isotope.makePageViewSortable=function(a){var b=new Sortables(a,{contstrain:!0,opacity:.6});b.active=!1,b.addEvent("start",function(){b.active=!0}),b.addEvent("complete",function(a){if(b.active)if(a.getPrevious()){var c=a.get("id").replace(/li_/,""),d=a.getPrevious().get("id").replace(/li_/,""),e=window.location.search.replace(/id=[0-9]*/,"id="+c)+"&act=cut&mode=1&page_id="+d;new Request({url:window.location.href,method:"get",data:e}).send()}else if(a.getParent()){var c=a.get("id").replace(/li_/,""),d=a.getParent().get("id").replace(/ul_/,""),e=window.location.search.replace(/id=[0-9]*/,"id="+c)+"&act=cut&mode=2&page_id="+d;new Request({url:window.location.href,method:"get",data:e}).send()}})}}(),Isotope.MediaManager={},function(){"use strict";Isotope.MediaManager.init=function(a,b,c){var d,e,f,g,h,i,j=$("ctrl_"+b),k=[],l={element:document.id(a),request:{endpoint:window.location.href,inputName:b,params:{action:"uploadMediaManager",name:b,REQUEST_TOKEN:Contao.request_token}},failedUploadTextDisplay:{mode:"custom",maxChars:50,responseProperty:"error"},validation:{allowedExtensions:c},callbacks:{onUpload:function(){AjaxRequest.displayBox(Contao.lang.loading+" …")},onComplete:function(a,c,l){if(!l.success)return AjaxRequest.hideBox(),void 0;if(l.file&&k.push(l.file),!(this.getInProgress()>0)){for(i={},g=j.getElements('[name^="'+b+'"]'),e=0;e<g.length;e++)d=g[e].get("name").split("["),3==d.length&&(f=d[1].replace("]",""),i[f]||(i[f]={}),h=d[2].replace("]",""),"radio"==g[e].get("type")?(i[f][h]||(i[f][h]=""),g[e].get("checked")&&(i[f][h]=g[e].get("value"))):i[f][h]=g[e].get("value"));new Request.Contao({evalScripts:!1,onSuccess:function(a,b){j.getElement("div").set("html",b.content),b.javascript&&Browser.exec(b.javascript),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"reloadMediaManager",name:b,value:i,files:k,REQUEST_TOKEN:Contao.request_token}),k=[]}}}};return new qq.FineUploader(l)},Isotope.MediaManager.makeSortable=function(){$$(".tl_mediamanager .sortable").each(function(a){new Sortables(a,{contstrain:!0,opacity:.6,handle:".drag-handle",onComplete:function(){Isotope.MediaManager.resort(a)}})})},Isotope.MediaManager.act=function(a,b,c){{var d=document.id(c).getElement("table"),e=d.getFirst("tbody"),f=document.id(a).getParent("tr");e.getChildren()}switch(Backend.getScrollOffset(),b){case"up":f.getPrevious()?f.injectBefore(f.getPrevious()):f.injectInside(e);break;case"down":f.getNext()?f.injectAfter(f.getNext()):f.injectBefore(e.getFirst());break;case"delete":f.destroy()}Isotope.MediaManager.resort(e)},Isotope.MediaManager.resort=function(a){var b,c,d,e,f=a.getChildren();for(d=0;d<f.length;d++){for(b=f[d].getElements("[name]"),e=0;e<b.length;e++)b[e].name=b[e].name.replace(/\[[0-9]+\]/g,"["+d+"]"),b[e].id=b[e].id.replace(/_[0-9]+/g,"_"+d);for(c=f[d].getElements("label"),e=0;e<c.length;e++)c[e].set("for",c[e].get("for").replace(/_[0-9]+/g,"_"+d))}}}(),window.addEvent("domready",function(){Isotope.addInteractiveHelp(),Isotope.makeSelectExtendable(),Isotope.MediaManager.makeSortable()}).addEvent("structure",function(){Isotope.addInteractiveHelp()}),window.addEvent("ajax_change",function(){Isotope.addInteractiveHelp(),Isotope.MediaManager.makeSortable()});