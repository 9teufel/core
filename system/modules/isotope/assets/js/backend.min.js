var Isotope={};!function(){"use strict";Isotope.toggleCheckboxGroup=function(e,t){var n=document.id(e).className,o=document.id(e).checked?"checked":"";"tl_checkbox"==n?$$("#"+t+" .tl_checkbox").each(function(e){e.disabled||(e.checked=o)}):"tl_tree_checkbox"==n&&$$("#"+t+" .parent .tl_tree_checkbox").each(function(e){e.disabled||(e.checked=o)}),Backend.getScrollOffset()},Isotope.openModalGroupSelector=function(e){var l=e||{},t=(window.getSize().y-180).toInt();(!l.height||l.height>t)&&(l.height=t);var n=new SimpleModal({width:l.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});return n.addButton(Contao.lang.close,"btn",function(){this.hide()}),n.addButton(Contao.lang.apply,"btn primary",function(){for(var e=[],t=null,n=window.frames,o=0;o<n.length;o++)if("simple-modal-iframe"==n[o].name){t=n[o];break}if(null!==t){var a=t.document.getElementById("tl_listing"),i=(a=a||t.document.getElementById("tl_select")).getElementsByTagName("input");for(o=0;o<i.length;o++)i[o].checked&&!i[o].id.match(/^check_all_/)&&(i[o].id.match(/^reset_/)||e.push(i[o].get("value")));new Request.Contao({evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){""!=e&&(window.location.href=e)},onFailure:function(e){302===e.status&&""!=e.responseText&&(window.location.href=e.responseText)}}).post({action:l.action,value:e[0],redirect:l.redirect,REQUEST_TOKEN:Contao.request_token}),this.hide(),l.trigger&&l.trigger.fireEvent("closeModal")}else alert("Could not find the SimpleModal frame")}),n.show({title:l.title,contents:'<iframe src="'+l.url+'" name="simple-modal-iframe" width="100%" height="'+l.height+'" frameborder="0"></iframe>',model:"modal"}),n},Isotope.openModalPageSelector=function(e){var l=e||{},t=(window.getSize().y-180).toInt();(!l.height||l.height>t)&&(l.height=t);var n=new SimpleModal({width:l.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});return n.addButton(Contao.lang.close,"btn",function(){this.hide()}),n.addButton(Contao.lang.apply,"btn primary",function(){for(var e=0,t=null,n=window.frames,o=0;o<n.length;o++)if("simple-modal-iframe"==n[o].name){t=n[o];break}if(null!==t){var a=t.document.getElementById("tl_listing"),i=(a=a||t.document.getElementById("tl_select")).getElementsByTagName("input");for(o=0;o<i.length;o++)i[o].checked&&!i[o].id.match(/^check_all_/)&&(i[o].id.match(/^reset_/)||(e=i[o].get("value")));new Request.Contao({evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){""!=e&&(window.location.href=e)},onFailure:function(e){302===e.status&&""!=e.responseText&&(window.location.href=e.responseText)}}).post({action:l.action,value:e,redirect:l.redirect,REQUEST_TOKEN:Contao.request_token}),this.hide()}else alert("Could not find the SimpleModal frame")}),n.show({title:l.title,contents:'<iframe src="'+l.url+'" name="simple-modal-iframe" width="100%" height="'+l.height+'" frameborder="0"></iframe>',model:"modal"}),n},Isotope.addInteractiveHelp=function(){new Tips.Contao("a.tl_tip",{offset:{x:9,y:21},text:function(e){return e.get("longdesc")}})},Isotope.inheritFields=function(e,i){var l=!1;e.each(function(e,t){var n=document.id("ctrl_"+e);if(n){n.removeProperty("required");var o=n.getParent("div").getFirst("h3");if(!o&&n.match(".tl_checkbox_single_container")&&(o=n),!o)return void(l=!0);o.addClass("inherit");var a=document.id("ctrl_inherit").getFirst("input[value="+e+"]");if(a.setStyle("float","right").inject(o),document.id("ctrl_inherit").getFirst("label[for="+a.get("id")+"]").setStyles({float:"right","padding-right":"5px","font-weight":"normal"}).set("text",i).inject(o),a.addEvent("change",function(e){var t=document.id("ctrl_"+e.target.get("value"));if(t.match(".tl_checkbox_single_container"))t.getFirst("input[type=checkbox]").disabled=e.target.checked;else{t.getPrevious()&&t.getPrevious().hasClass("mce-tinymce")?t.getPrevious().setStyle("display",e.target.checked?"none":null):t.setStyle("display",e.target.checked?"none":null);try{t.getAllNext(":not(script)").setStyle("display",e.target.checked?"none":null)}catch(e){}}}),n.match(".tl_checkbox_single_container"))n.getFirst("input[type=checkbox]").disabled=a.checked;else{n.setStyle("display",a.checked?"none":null);try{n.getAllNext(":not(script)").setStyle("display",a.checked?"none":null)}catch(e){}}}}),l||document.id("ctrl_inherit").getParent("div").setStyle("display","none")},Isotope.makeSelectExtendable=function(){var i={};document.getElements("select.extendable").forEach(function(n){var o=n.value,a=n.getParent("table").id;i[a]=i[a]||[],i[a].push(n),n.grab(new Element("option",{text:"Add …",value:"extendSelect"})).addEvent("change",function(e){if("extendSelect"==n.value){var t=prompt("Please enter the new group name.");""!=t?(a&&i[a]?i[a].forEach(function(e){new Element("option",{text:t,value:t}).inject(e.getLast(),"before")}):new Element("option",{text:t,value:t}).inject(n.getLast(),"before"),n.value=t,o=t):n.value=o,n.fireEvent("change")}else o=n.value})})},Isotope.makeParentViewSortable=function(e){var t=new Scroller(document.getElement("body"),{onChange:function(e,t){this.element.scrollTo(this.element.getScroll().x,t)}}),i=new Sortables(e,{contstrain:!0,opacity:.6,onStart:function(){t.start()},onComplete:function(){t.stop()},onSort:function(e){var t,n,o,a=e.getFirst("div");a&&(a.hasClass("wrapper_start")?((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.removeClass("indent"),(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.addClass("indent")):a.hasClass("wrapper_stop")?((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.addClass("indent"),(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.removeClass("indent")):a.hasClass("indent")?((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.hasClass("wrapper_stop")||(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.hasClass("wrapper_start"))&&a.removeClass("indent"):((t=e.getPrevious("li"))&&(o=t.getFirst("div"))&&o.hasClass("wrapper_start")||(n=e.getNext("li"))&&(o=n.getFirst("div"))&&o.hasClass("wrapper_stop"))&&a.addClass("indent"))},handle:".drag-handle"});i.active=!1,i.addEvent("start",function(){i.active=!0}),i.addEvent("complete",function(e){var t,n,o,a;i.active&&(e.getPrevious("li")?(t=e.get("id").replace(/li_/,""),n=e.getPrevious("li").get("id").replace(/li_/,""),o=window.location.search.replace(/id=[0-9]*/,"id="+t)+"&act=cut&mode=1&page_id="+n,a=window.location.href.replace(/\?.*$/,""),new Request.Contao({url:a+o,followRedirects:!1}).get()):e.getParent("ul")&&(t=e.get("id").replace(/li_/,""),n=e.getParent("ul").get("id").replace(/ul_/,""),o=window.location.search.replace(/id=[0-9]*/,"id="+t)+"&act=cut&mode=2&page_id="+n,a=window.location.href.replace(/\?.*$/,""),new Request.Contao({url:a+o,followRedirects:!1}).get()))})}}(),Isotope.MediaManager={},function(){"use strict";Isotope.MediaManager.init=function(e,o,t){var a,i,l,r,s,c,d=$("ctrl_"+o),u=[],n={element:document.id(e),request:{endpoint:window.location.href,inputName:o,params:{action:"uploadMediaManager",name:o,REQUEST_TOKEN:Contao.request_token}},failedUploadTextDisplay:{mode:"custom",maxChars:50,responseProperty:"error"},validation:{allowedExtensions:t},callbacks:{onUpload:function(){AjaxRequest.displayBox(Contao.lang.loading+" …")},onComplete:function(e,t,n){if(n.success){if(n.file&&u.push(n.file),!(0<this.getInProgress())){for(c={},r=d.getElements('[name^="'+o+'"]'),i=0;i<r.length;i++)3==(a=r[i].get("name").split("[")).length&&(l=a[1].replace("]",""),c[l]||(c[l]={}),s=a[2].replace("]",""),"radio"==r[i].get("type")?(c[l][s]||(c[l][s]=""),r[i].get("checked")&&(c[l][s]=r[i].get("value"))):c[l][s]=r[i].get("value"));new Request.Contao({evalScripts:!1,onSuccess:function(e,t){d.getElement("div").set("html",t.content),t.javascript&&Browser.exec(t.javascript),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"reloadMediaManager",name:o,value:c,files:u,REQUEST_TOKEN:Contao.request_token}),u=[]}}else AjaxRequest.hideBox()}}};return new qq.FineUploader(n)},Isotope.MediaManager.makeSortable=function(){$$(".tl_mediamanager .sortable").each(function(e){new Sortables(e,{contstrain:!0,opacity:.6,handle:".drag-handle",onComplete:function(){Isotope.MediaManager.resort(e)}})})},Isotope.MediaManager.act=function(e,t,n){var o=document.id(n).getElement("table").getFirst("tbody"),a=document.id(e).getParent("tr");o.getChildren();switch(Backend.getScrollOffset(),t){case"up":a.getPrevious()?a.injectBefore(a.getPrevious()):a.injectInside(o);break;case"down":a.getNext()?a.injectAfter(a.getNext()):a.injectBefore(o.getFirst());break;case"delete":a.destroy()}Isotope.MediaManager.resort(o)},Isotope.MediaManager.resort=function(e){var t,n,o,a,i=e.getChildren();for(o=0;o<i.length;o++){for(t=i[o].getElements("[name]"),a=0;a<t.length;a++)t[a].name=t[a].name.replace(/\[[0-9]+\]/g,"["+o+"]"),t[a].id=t[a].id.replace(/_[0-9]+/g,"_"+o);for(n=i[o].getElements("label"),a=0;a<n.length;a++)n[a].set("for",n[a].get("for").replace(/_[0-9]+/g,"_"+o))}}}(),window.addEvent("domready",function(){Isotope.addInteractiveHelp(),Isotope.makeSelectExtendable(),Isotope.MediaManager.makeSortable()}).addEvent("structure",function(){Isotope.addInteractiveHelp()}),window.addEvent("ajax_change",function(){Isotope.addInteractiveHelp(),Isotope.MediaManager.makeSortable()});